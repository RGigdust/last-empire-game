<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LAST Empire | Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ø£Ø³ÙˆØ¯</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: sans-serif; }
        canvas { display: block; margin: 0 auto; }
        #loading { color: #ffd700; text-align: center; margin-top: 50%; font-weight: bold; font-size: 20px; }
    </style>
</head>
<body>
    <div id="loading">Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ø§Ù„Ø¹Ø±ÙŠÙ†... ğŸ¦</div>
    <div id="game-container"></div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        const config = {
            type: Phaser.AUTO,
            width: window.innerWidth,
            height: window.innerHeight,
            backgroundColor: '#0a0a0a',
            parent: 'game-container',
            physics: { default: 'arcade', arcade: { gravity: { y: 0 } } },
            scene: { preload: preload, create: create, update: update }
        };

        const game = new Phaser.Game(config);
        let lion, scoreText, balance = 0, distance = 0;
        let lastPos = { x: 0, y: 0 };

        function preload() {
            // ØµÙˆØ± Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† Ø³Ø±ÙŠØ¹Ø© Ø¹Ø´Ø§Ù† Ø§Ù„Ø¯Ø§ØªØ§
            this.load.image('lion', 'https://cdn-icons-png.flaticon.com/512/616/616412.png'); 
            this.load.image('bg', 'https://img.freepik.com/free-vector/dark-night-forest-landscape-with-coniferous-trees_107791-1869.jpg');
        }

        function create() {
            document.getElementById('loading').style.display = 'none';
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØªØ¸Ø¨ÙŠØ· Ø­Ø¬Ù…Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©
            let bg = this.add.image(window.innerWidth/2, window.innerHeight/2, 'bg');
            bg.setDisplaySize(window.innerWidth, window.innerHeight);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¯ (Ø§Ù„Ø¨Ø·Ù„)
            lion = this.physics.add.sprite(window.innerWidth/2, window.innerHeight/2, 'lion').setScale(0.15);
            lion.setCollideWorldBounds(true);
            
            lastPos.x = lion.x;
            lastPos.y = lion.y;

            // Ù†Øµ Ø§Ù„Ø±ØµÙŠØ¯
            scoreText = this.add.text(20, 40, `ğŸ’° $LAST: 0`, {
                fontSize: '28px', fill: '#ffd700', fontWeight: 'bold', stroke: '#000', strokeThickness: 5
            });

            // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ (Ø§ØªØ­Ø±Ùƒ ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ù„Ø£Ø³Ø¯ Ù‡ÙŠØ¬Ø±ÙŠ ÙˆØ±Ø§Ùƒ)
            this.input.on('pointermove', (pointer) => {
                this.physics.moveToObject(lion, pointer, 250);
            });
        }

        function update() {
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø·ÙˆØ¹Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ†
            let d = Phaser.Math.Distance.Between(lion.x, lion.y, lastPos.x, lastPos.y);
            
            if (d > 2) { // Ù„Ùˆ Ø§Ù„Ø£Ø³Ø¯ Ø¨ÙŠØªØ­Ø±Ùƒ ÙØ¹Ù„Ø§Ù‹
                distance += d;
                lastPos.x = lion.x;
                lastPos.y = lion.y;

                // ÙƒÙ„ Ù…Ø§ ÙŠÙ…Ø´ÙŠ 1000 Ø¨ÙƒØ³Ù„ ÙŠØ§Ø®Ø¯ Ø¹Ù…Ù„Ø©
                if (distance >= 1000) { 
                    balance += 1;
                    distance = 0;
                    scoreText.setText(`ğŸ’° $LAST: ${balance}`);
                    // Ø§Ù‡ØªØ²Ø§Ø² Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù…Ø¹ ÙƒÙ„ Ø¹Ù…Ù„Ø© (Haptic Feedback)
                    tg.HapticFeedback.impactOccurred('light');
                }
            } else {
                lion.body.setVelocity(0); // ÙˆÙ‚Ù Ø§Ù„Ø£Ø³Ø¯ Ù„Ùˆ Ù…ÙÙŠØ´ Ù„Ù…Ø³
            }
        }
    </script>
</body>
</html>
